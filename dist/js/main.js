var ioann=angular.module("ioann",["ngRoute","angular-toArrayFilter","ngAnimate"]);ioann.config(["$routeProvider",function(o){o.when("/",{templateUrl:"partials/land.html",controller:"landCtrl"}).when("/family",{templateUrl:"partials/family.html",controller:"familyCtrl"}).when("/celebrations",{templateUrl:"partials/celebrations.html",controller:"celebrationsCtrl"}).otherwise({redirectTo:"/"})}]),ioann.controller("landCtrl",["$scope","$timeout",function(o,e){o.videoplayng=!1;var n=null;videojs.getPlayers().div_video&&videojs("div_video").dispose(),videojs("div_video",{bigPlayButton:!1}).ready(function(){o.video=this,o.hideVideo=function(){o.videoplayng=!1,o.video.posterImage.show(),o.video.userActive(!1),n=null},o.showVideo=function(){o.videoplayng=!0,o.video.userActive(!0)},o.video.on("ended",function(){e(o.hideVideo),o.video.currentTime(0)}),o.video.on("pause",function(){n=e(o.hideVideo,200)}),o.video.on("play",function(){null!=n?e.cancel(n):e(o.showVideo)}),o.closeVideo=function(){o.video.pause()},o.playVideo=function(){o.video.play()}})}]),ioann.controller("familyCtrl",["$scope","$http",function(o,e){o.showpers=!1,o.personalys=[],o.points=[],o.showpeople=function(){0===o.personalys.length?e.get("/data/personalys.json").then(function(e){o.personalys=e.data,o.showpers=!o.showpers}):o.showpers=!o.showpers},o.selectPersonaly=function(e){angular.forEach(o.personalys,function(o){o.visible=!1}),e.visible=!0},o.getPoints=function(){e.get("/data/pointsmap.json").then(function(e){o.points=e.data,o.showpoints=!o.showpoints})},o.getPoints()}]),ioann.controller("celebrationsCtrl",["$scope","$http",function(o,e){o.showpers=!1,o.showchrons=!1,o.showpoints=!1,o.mousedown=!1,o.showvideo=!1,o.personalys=[],o.chronics=[],videojs.getPlayers().div_video&&videojs("div_video").dispose(),videojs("div_video",{bigPlayButton:!1}).ready(function(){o.video=this}),o.map=L.map("mapid",{zoomControl:!1,attributionControl:!1}).setView([61.66235,40.2058416666667],6),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}",{attribution:'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://mapbox.com">Mapbox</a>',maxZoom:18,id:"lenseg.00o6mm4a",accessToken:"pk.eyJ1IjoibGVuc2VnIiwiYSI6ImNpbm8yeTlqazB6bm91Nmx5OHhycnNwN3AifQ.2_7w87K3h6dfp_ohKsS1Gg"}).addTo(o.map);var n=L.divIcon({className:"map-celebration-point",popupAnchor:L.point(0,0)}),t=L.divIcon({className:"map-celebration-point-big",popupAnchor:L.point(0,0)}),i=function(o,e){return o.properties.bigicon?L.marker(e,{icon:t}):L.marker(e,{icon:n})};geoJsonObj=[{type:"Feature",properties:{Name:"Кронштадт",Description:""},geometry:{type:"Point",coordinates:[29.7774972222222,59.9927666666667,0]}},{type:"Feature",properties:{bigicon:!0,Name:"Санкт-Петербург",Description:""},geometry:{type:"Point",coordinates:[30.3353111111111,59.9313638888889,0]}},{type:"Feature",properties:{Name:"Коноша",Description:""},geometry:{type:"Point",coordinates:[40.2539055555556,60.9735333333333,0]}},{type:"Feature",properties:{Name:"Няндома",Description:""},geometry:{type:"Point",coordinates:[40.2058416666667,61.66235,0]}},{type:"Feature",properties:{Name:"Плесецк",Description:""},geometry:{type:"Point",coordinates:[40.2957916666667,62.7079472222222,0]}},{type:"Feature",properties:{bigicon:!0,Name:"Обозерская",Description:""},geometry:{type:"Point",coordinates:[40.3113916666667,63.4488888888889,0]}},{type:"Feature",properties:{Name:"Архангельск",Description:""},geometry:{type:"Point",coordinates:[40.5747222222222,64.5508333333333,0]}},{type:"Feature",properties:{Name:"Карпогоры",Description:""},geometry:{type:"Point",coordinates:[44.4041638888889,64.0416694444444,0]}},{type:"Feature",properties:{Name:"Сура",Description:""},geometry:{type:"Point",coordinates:[45.6324,63.5755361111111,0]}}];var r=L.geoJson(geoJsonObj,{pointToLayer:i}).addTo(o.map),s=L.polyline([],{color:"#f7f7f7",weight:2,opacity:1}).addTo(o.map);r.eachLayer(function(o){s.addLatLng(o.getLatLng())}),o.showPhotos=function(){},o.playVideo=function(e){console.log(e),o.video.src(e),o.showvideo=!0,o.video.play()},o.closeVideo=function(){o.showvideo=!1,o.video.pause()},o.showhroniks=function(){0===o.chronics.length?e.get("/data/chronics.json").then(function(e){o.chronics=e.data,o.chronics[Object.keys(o.chronics)[0]].visible=!0,o.chronicsscren=o.chronics[Object.keys(o.chronics)[0]].screenshot,o.showchrons=!o.showchrons}):o.showchrons=!o.showchrons},o.selectChronic=function(e){angular.forEach(o.chronics,function(o){o.visible=!1}),e.visible=!0},o.chronickMousover=function(e){o.mousedown&&o.selectChronic(e)},o.chronickMousedown=function(){o.mousedown=!0},document.documentElement.addEventListener("mouseup",function(e){o.mousedown=!1})}]);